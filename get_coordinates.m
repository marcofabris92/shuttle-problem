function [S,radius] = get_coordinates()
% stop coordinates at the Portello area
r = 6371000; % Earth radius in meters

% gathering latitude and longitude coordinates
coordinates = [... % latitude, longitude;
    1,45.41583292562394,11.882016349388659
    2,45.41648020567833,11.889251799667715
    3,45.37859630228826,11.865547571723459
    4,45.34674980635165,11.867681404805163
    5,45.26704768056037,11.863436623092422
    6,45.23316604421127,11.868029698633634
    7,45.211192970456665,11.938284040395505
    8,45.27050512435821,11.932691831946421
    9,45.31609000348568,11.913726920921713
    10,45.36382924303833,11.936473984289503
    11,45.34568777002649,11.964034712983182
    12,45.301489382528175,12.028728197288535
    13,45.24843919897832,12.026390512936194
    14,45.21667656110733,12.081013701643446
    15,45.196458032857045,12.2054854954144
    16,45.215009959895674,12.293833174583046
    17,45.19916348406595,12.300907860413608
    18,45.22470490032733,12.192268205086638
    19,45.2335615771912,12.164839004325234
    20,45.267874826700364,12.106327830894875
    21,45.32936185697524,12.124251148686414
    22,45.33648884315173,12.082106864452276
    23,45.358059166964935,12.092157584821129
    24,45.373124024063884,11.987249029782253
    25,45.400695227255774,11.948110851669481
    26,45.41356547643177,11.963985883248398
    27,45.38355730080075,12.072822988303045
    28,45.38798743274292,12.1281479013198
    29,45.409000230045535,12.006407606684288
    30,45.44419586080318,11.985143411710697
    31,45.424602038634575,12.075397126800768
    32,45.433567598780336,12.12302748488572
    33,45.439667245005815,12.199883482715741
    34,45.50384305652896,12.038993577067425
    35,45.49230926607975,12.101407640315747
    36,45.49236156955301,12.162793910162868
    37,45.479721508998146,12.238875960056497
    38,45.491608439500695,12.245317581541181
    39,45.44058766513289,12.31291741599809
    40,45.43839940927721,12.318597118045309
    41,45.50255154952266,12.337004831212449
    42,45.5072353921715,12.337488298480448];

coordinates = coordinates(:,2:3);



% computung the tangent plane w.r.t. the average point
% format long
mean(coordinates(:,1));
mean(coordinates(:,2));
theta = mean(coordinates(:,1))*pi/180; % average latitude
phi = mean(coordinates(:,2))*pi/180; % average longitude
Ry = [sin(theta) 0 -cos(theta);
      0          1 0;
      cos(theta) 0 sin(theta)];
Rz = [cos(phi)  sin(phi) 0;
      -sin(phi) cos(phi) 0;
      0         0        1];
R = Ry*Rz;
Cx = r*cos(theta)*cos(phi);
Cy = r*cos(theta)*sin(phi);
Cz = r*sin(theta);
C = [Cx Cy Cz]';
n = C/norm(C);
% equation of the plane: PI: n(1)*x+n(2)*y+n(3)*z = r


N = length(coordinates(:,1));
P = zeros(N,3); % conversion to 3D coordinates
S = zeros(N,2); % projections of points P onto the plane w.r.t. C
radius = 0; % radius of the area
for i = 1:N
    lat = coordinates(i,1)*pi/180;
    lon = coordinates(i,2)*pi/180;
    P(i,1) = r*cos(lat)*cos(lon);
    P(i,2) = r*cos(lat)*sin(lon);
    P(i,3) = r*sin(lat);
    Q = P(i,:)'-((P(i,:)-C')*n)*n; % projection of P onto PI
    s = R*(Q-C); % rototranslation of Q to express it w.r.t. the plane centered on C
    S(i,:) = [s(2) -s(1)]; % planar frame rotation by 90Â°
    radius = max(radius,norm(S(i,:)));
end

radius = 1.1*radius;

end









 